<!-- Copyright Indra Sistemas, S.A. 2013-2018 SPAIN -->
<html xmlns:th="http://www.thymeleaf.org" xmlns:dt="http://www.thymeleaf.org/dandelion/datatables" th:with="lang=${#locale.language}" th:lang="${lang}">
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
		<meta http-equiv="X-UA-Compatible" content="IE=Edge"/>
		<meta http-equiv="Content-Language" th:content="${lang}"/>
		<title th:text="#{name.app}"/>
		
		<!-- BEGIN WEB FONT -->
		<script src="https://ajax.googleapis.com/ajax/libs/webfont/1.6.16/webfont.js"></script>
		<script>
          WebFont.load({
            google: {"families":["Poppins:300,400,500,600,700","Open Sans:300,400,500,600,700"]},
            active: function() {
                sessionStorage.fonts = true;
            }
          });
		</script>

		<!-- STYLE SHEETS -->
		<link rel="stylesheet" type="text/css" media="all" th:href="@{/static/css/bootstrap.min.css}"/>
		<link rel="stylesheet" type="text/css" media="all" th:href="@{/static/css/components.css}"/>
		<link rel="stylesheet" type="text/css" media="all" th:href="@{/static/css/plugins.css}"/>
		<link rel="stylesheet" type="text/css" media="all" th:href="@{/static/css/layout.css}"/>
		<!-- THEME -->
		<link rel="stylesheet" type="text/css" media="all" th:href="@{/static/webjars/sofia2_theme/css/sofia2.css}"/>
		
		<!-- PLUGINS STYLE SHEETS -->
		<link rel="stylesheet" type="text/css" media="all" th:href="@{/static/css/devicon.css}"/>
	</head>	
	
	<!-- page-sidebar-closed to start page with collapsed menu -->
	<body class="page-header-fixed  page-content-white page-sidebar-closed">

	<!-- MAIN PAGE WRAPPER -->
	<div class="page-wrapper">
	
		<!-- BEGIN HEADER INCLUDE -->
		<div th:include="fragments/header::#headerFragment" class="page-header navbar navbar-fixed-top"></div>
		<!-- END HEADER -->
		
		<!-- BEGIN HEADER AND CONTENT DIVIDER -->
		<div class="clearfix"> </div>		
			
		<!-- BEGIN SIDEBAR -->
		<div th:include="fragments/menu::#menuFragment" class="page-sidebar-wrapper"></div>
		<!-- END SIDEBAR -->
		
				
		<!-- BEGIN CONTENT -->
		<div class="page-content-wrapper">
			
			<!-- BEGIN CONTENT BODY -->
			<div class="page-content">
				
				<!-- BEGIN PAGE HEADER-->
				
				<!-- BEGIN PAGE BAR AND BREADCRUM -->
				<div class="page-bar margin-bottom-20">
					<ul class="page-breadcrumb">
						<li><i class="la la-home"></i> <a th:href="@{/}">Home</a><i class="fa fa-circle"></i></li>						
						<li><span th:text="#{dashboards.my}">My Dashboards</span></li>
					</ul>						
				</div>
				<!-- END PAGE BAR -->
				
				<!-- BEGIN PAGE TITLE-->
				<h1 class="page-title hide "><span th:text="#{dashboards.my}">My Dashboards </span></h1>
				<!-- END PAGE TITLE-->			
				
				<!-- MAIN ROW -->
				<div class="row">
					<div class="col-md-12">
					
						<div class="portlet light bordered">
							<div class="portlet-title">
								<div class="caption">
									<i class="icon-list font-grey-gallery"></i>
									<span class="caption-subject bold font-grey-gallery uppercase" th:text="#{dashboards.my}">My Dashboards </span>
									<!-- <span class="caption-helper">Subtitulo de contenedor</span> -->
								</div>									
								<div class="tools">
									<a href="" class="collapse" data-original-title="" title=""> </a>
									<a href="" class="fullscreen" data-original-title="" title=""> </a>
								</div>								
								<div class="actions margin-right-20">
									<div class="btn-group">									
										<button id="search-toggle" type="button" class="hide btn grey-mint sbold btn-outline" onclick="$('#searchFilter').toggleClass('hide')"><i class="fa fa-search"></i> <span th:text="#{gen.search}"> Search </span></button>									
										<div class="input-group input-group-sm">
											
											<input style="border: 1px solid #555;" th:placeholder="#{gen.filter} + '...'" class="btn-search-proyect form-control input-xsmall" type="text"/>
											
										</div>

									</div>										
								</div>
							</div>
							<div class="portlet-body" style="display: block; height: auto;">
								
								<div class="row">									
								
																								
									<div class="col-md-12 proyect-list margin-bottom-40" style="padding: 20px;">
										<!-- ASSET CONTAINER class="project-container col-md-4 col-sm-6 col-xs-12 + project_type + proyect state" -->
										<div th:each="dashboard : ${dashboards}" th:class="'project-container col-md-3 col-sm-6 col-xs-12' ">
											<!-- ASSET PANEL va con fondo blanco, tocar panel-defautl para hacer un panel-white -->
											<div class="panel panel-white effect-1">
												<div class="panel-heading ">																						  
												
													<a th:href="@{|/dashboards/view/${dashboard.id}|}"><div class="uppercase no-wrap text-truncate-md project-title" th:title="${dashboard.identification}" th:text="${dashboard.identification}" >Identification</div></a>
													
													<a th:href="@{|/dashboards/view/${dashboard.id}|}"><img  th:src="@{/img/} + 'APPLICATION.png'"  class="img-responsive img-market thumbnail popovers" data-trigger="hover" data-placement="bottom" data-container="body" th:attr="data-content=${dashboard.description},data-title=${dashboard.identification}" style="border:none!important;" /></a>
													
													
												</div>
												<div class="panel-body panel-project" style="display: none;">
													<div th:if="${!dashboard.description.isEmpty()}" class="project-description" style="text-align: justify;padding: 10px;" th:title="${dashboard.description}">
														<span style="display:block; margin-bottom:15px;" th:text="${dashboard.description}">Description</span>
														<div class="clearfix"></div>														
													</div>
													<div th:if="${dashboard.description.isEmpty()}"  class="project-description" style="text-align: justify;padding: 15px;"> No Desc.</div>
												</div>
												
											</div>
										</div>
										<!-- FIN CONTENEDOR DE PROYECTO -->
										
									
										
										<!-- ALERT filter: no-data -->
										<div id="proyect-list-alert" class="alert alert-warning margin-both-10 alert-dismissable hide">
											<button type="button" class="close" data-dismiss="alert" aria-hidden="true"></button>
											<i class="la la-warning font-lg"></i> <strong><span th:text="#{marketasset.template.list}">Markeplace Assets</span>: </strong> <span th:text="#{marketasset.filter.nodata}">No Assets with this Type.</span>
										</div>	
									</div>
									
									
									
								</div>
							</div>
						</div><!-- END PORTLET BASIC LIGHT -->							
										
					</div><!-- END COL-12 -->						
				</div><!-- END MAIN ROW -->				
			</div><!-- END CONTENT BODY -->
		</div><!-- END CONTENT page-content-wrapper -->		
	</div>
	<!-- END MAIN PAGE WRAPPER -->
	
	<!-- FOOTER-INCLUDE -->
	<footer th:include="fragments/footer::#footerFragment" class="page-footer"> </footer>	
	
	<!-- CORE CONTROLLERS -->
	<script th:src="@{/static/js/app.js}"/>
	<script th:src="@{/static/js/layout.js}"/>
	
	<!-- PLUGINS -->
	<script th:src="@{/static/vendor/jquery/jquery.dataTables.min.js}"/>
	<script th:src="@{/static/vendor/datatable/datatables.bootstrap.js}"/>	
	<script th:src="@{/static/vendor/jquery/jquery.autocomplete.js}"/>
	
	
	<script type="text/javascript" th:inline="javascript">	
	
	// TEMPLATE SEARCH FORM.
	var sname = [[${param.name}]] || '';
	var stype = [[${param.type}]] || '';
	
	sname ? $('#name').val(sname) : sname = '';
	stype ? $('#type').val(stype) : stype = '';
	console.log('SEARCHING ... [ Name: ' + sname + ' Type: ' + stype + ']');
	if (( sname != '') || (stype != '')) { $('#search-toggle').trigger('click'); }
	
	// DATATABLES LANGUAJE FROM PROPERTIES.
	datatable_lang = [[#{datatables_lang}]];	
	var languageJson = JSON.parse(datatable_lang);
	if ( languageJson ){ $.extend( true, $.fn.dataTable.defaults, { language: languageJson }); }

	</script>
	
	<script type="text/javascript"  th:inline="javascript">	
	//<![CDATA[
	var optionName = 'DASHBOARDS';
	
	
	
	
	function navigateUrl(url){  window.location.href = url;	}
	
	// MAIN WHEN READY
	$( document ).ready(function() {
	
	
		// AUTO COMPLETE ON DASHBOARD IDENTIFICATION/NAME
		$.ajax({ url: "getNamesForAutocomplete", type: 'POST', dataType: 'json', contentType: 'application/json', mimeType: 'application/json',
			success: function (source) {			 
						var namesArray = new Array();
						for( var i = 0; i < source.length; i++ ){
							namesArray[i] = { value: source[i] , data: source[i]};
						}
						
						// INIT AJAX AUTO COMPLETE
				$('#identification').autocomplete({ 
					lookup: namesArray,
					lookupFilter: function(suggestion, originalQuery, queryLowerCase) {
						var re = new RegExp('\\b' + $.Autocomplete.utils.escapeRegExChars(queryLowerCase), 'gi');
						return re.test(suggestion.value);
					}	
				});
			}
		});
		
		//SHOW/HIDE DATATABLE COLUMNS HANDLER
		$('label.toggle-vis').on( 'click', function (e) {
			e.preventDefault(); 
			// Get the column API object
			var column = $('#dashboards').DataTable().column( $(this).attr('data-column') ); 
			// Toggle the visibility
			column.visible( ! column.visible() );			
			// toggle Text
			$(this).toggleClass('text-muted line-through');			
		});	
		
		// SEARCH FORM RESET
		$('#reset_dashboard').on('click',function(){
			$('#form_dashboard')[0].reset();
			$('#form_dashboard')[0].submit();
		});
		
		var createDashboard = function(name){
			$.post(
				"/controlpanel/dashboards/create", 
				{identification : name}
			).done(function(id){
				navigateUrl("/controlpanel/dashboards/editfull/" + id)}
			).fail(
				function(e){
					console.log("Error creating dashboard, message detail: " + e.responseText);
				}
			)
		}
		
		// SEARCH FORM
		$('#search_dashboard').on('click',function(){ $('#form_dashboard')[0].submit(); });
		
		
		
	});
	 
	// MAIN WHEN LOAD
	$(window).load(function(){  
		
		// SHOW/HIDE DATATABLES COLUMN INIT 		
		$('.dataTables_filter').append($('#dataTable-vis-toggle'));		
		$('#dataTable-vis-toggle').removeClass('hide');
		
		// HIDE COLUMNS (DeESCRIPTION,  CREATEDAT)		
		$.each([ 2,4 ],function(ind,value){ $("label.toggle-vis[data-column='"+ value +"']").trigger('click'); });
		
	});	
	
	
	//]]>
	</script>
	
</body>
</html> 
