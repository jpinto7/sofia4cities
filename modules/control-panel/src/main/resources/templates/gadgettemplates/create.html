
<!-- Copyright Indra Sistemas, S.A. 2013-2018 SPAIN -->
<html xmlns:th="http://www.thymeleaf.org" th:with="lang=${#locale.language}" th:lang="${lang}">

	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
		<meta http-equiv="X-UA-Compatible" content="IE=Edge"/>
		<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/>
		<meta http-equiv="Content-Language" th:content="${lang}"/>
		<title th:text="#{name.app}"/>
	    <meta name="description" content="Gadget list template"/>
		<meta name="keywords" content="sofia2,smart,cities,platform,Indra"/>
		<meta name="author" content="Indra Sistemas, S.A."/>
		
		<!-- BEGIN WEB FONT -->
		
		<script src="https://ajax.googleapis.com/ajax/libs/webfont/1.6.16/webfont.js"></script>
		<script>
          WebFont.load({
            google: {"families":["Poppins:300,400,500,600,700","Open Sans:300,400,500,600,700"]},
            active: function() {
                sessionStorage.fonts = true;
            }
          });
		</script>
		
		<script>
		    window.__env = window.__env || {};
		    window.__env.socketEndpointConnect = '/dashboardengine/dsengine/solver';
		    window.__env.socketEndpointSend = '/dsengine/solver';
		    window.__env.socketEndpointSubscribe = '/dsengine/broker';
		    window.__env.endpointSofia2ControlPanel = '/controlpanel';
		    window.__env.endpointSofia2DashboardEngine = '/dashboardengine';
		    window.__env.dashboardEngineUsername = 'administrator';
		    window.__env.dashboardEnginePassword = 'changeIt!';
		    window.__env.dashboardEngineLoginRest = '/loginRest';
		    window.__env.enableDebug = false;
		
		</script>

		<!-- STYLE SHEETS -->
		<link rel="stylesheet" type="text/css" media="all" th:href="@{/static/css/bootstrap.min.css}"/>
		<link rel="stylesheet" type="text/css" media="all" th:href="@{/static/css/components.css}"/>
		<link rel="stylesheet" type="text/css" media="all" th:href="@{/static/css/plugins.css}"/>
		<link rel="stylesheet" type="text/css" media="all" th:href="@{/static/css/layout.css}"/>
		<!-- <link rel="stylesheet" type="text/css" media="all" th:href="@{/static/css/gadgets.css}"/> -->
		<!-- THEME -->
		<link rel="stylesheet" type="text/css" media="all" th:href="@{/static/webjars/sofia2_theme/css/sofia2.css}"/>
		
		<!-- PLUGINS STYLE SHEETS -->
			<!-- PLUGINS STYLE SHEETS: BOOSTRAP-SELECT AND CODEMIRROR  -->
		<link rel="stylesheet" type="text/css" media="all" th:href="@{/static/vendor/bootstrap-select/bootstrap-select.min.css}"/>
		<link rel="stylesheet" type="text/css" media="all" th:href="@{/static/vendor/codemirror/lib/codemirror.css}"/>
		<link rel="stylesheet" type="text/css" media="all" th:href="@{/static/vendor/codemirror/theme/neat.css}"/>
		<link rel="stylesheet" type="text/css" media="all" th:href="@{/static/vendor/codemirror/theme/ambiance.css}"/>
		<link rel="stylesheet" type="text/css" media="all" th:href="@{/static/vendor/codemirror/theme/material.css}"/>
		<link rel="stylesheet" type="text/css" media="all" th:href="@{/static/vendor/codemirror/theme/neo.css}"/>
		  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet"/>
		
		<style>
		md-progress-circular { display: hide; visibility: hidden; }
		</style>
	</head>	
	
	<!-- page-sidebar-closed to start page with collapsed menu -->
	<body class="page-header-fixed  page-content-white page-sidebar-closed">


	<!-- MAIN PAGE WRAPPER -->
	<div class="page-wrapper">
	
		<!-- BEGIN HEADER INCLUDE -->
		<div th:include="fragments/header::#headerFragment" class="page-header navbar navbar-fixed-top"></div>
		<!-- END HEADER -->
		
		<!-- BEGIN HEADER AND CONTENT DIVIDER -->
		<div class="clearfix"> </div>		
			
		<!-- BEGIN SIDEBAR -->
		<div th:include="fragments/menu::#menuFragment" class="page-sidebar-wrapper"></div>
		<!-- END SIDEBAR -->
		
		<!-- BEGIN CONTENT -->
		<div class="page-content-wrapper">
			
			<!-- BEGIN CONTENT BODY -->
			<div class="page-content">
				
				<!-- BEGIN PAGE HEADER-->
				
				<!-- BEGIN PAGE BAR AND BREADCRUM -->
				<div class="page-bar margin-bottom-20">
					<ul class="page-breadcrumb">
						<li><i class="la la-home"></i> <a th:href="@{/}">Home</a><i class="fa fa-circle"></i></li>						
						<li><a th:href="@{/gadgettemplates/list}"> <span th:text="#{gadgettemplates.my}">My Gadget Templates </span></a><i class="fa fa-circle"></i> </li>
						<li><span th:if="${gadgetTemplate.id} == null" th:text="#{gadgettemplates.create}">Create Gadget Template</span>
						    <span th:if="${gadgetTemplate.id} != null" th:text="#{gadgettemplates.update}">Update Gadget Template</span>
						</li>
					</ul>						
				</div>
				<!-- END PAGE BAR -->
				
				<!-- BEGIN PAGE TITLE-->
				<h1 class="page-title hide "><span th:text="#{gadgettemplates.create}">Create Gadget Template</span></h1>
				<!-- END PAGE TITLE-->			
				
				<!-- MAIN ROW -->
				<div class="row">
					<div class="col-md-12">
					
						<div class="portlet light bordered">
							<div class="portlet-title">
								<div class="caption">
									<i class="icon-list font-grey-gallery"></i>
									<span  th:if="${gadgetTemplate.id} == null" class="caption-subject bold font-grey-gallery uppercase" th:text="#{gadgettemplates.create}" > Create Gadget Template </span>
								    <span  th:if="${gadgetTemplate.id} != null" class="caption-subject bold font-grey-gallery uppercase" th:text="#{gadgettemplates.update}" > Create Gadget Template </span>
									<!-- <span class="caption-helper">Subtitulo de contenedor</span> -->
								</div>									
								<div class="tools">
									<!--  <a href="" class="collapse" data-original-title="" title=""> </a>-->
									<a href="" class="fullscreen" data-original-title="" title=""> </a>
								</div>
								<div class="actions">
									<!-- ACTION INDICATORs -->
									<span th:if="${gadgetTemplate.id} == null"
										class="label label-success label-sm uppercase"><i
										class="fa fa-plus"></i> <span th:text="#{gen.mode.insert}">Insert</span></span>
									<span th:if="${gadgetTemplate.id} != null"
										class="label label-warning label-sm uppercase bold "><i
										class="fa fa-edit"></i> <span th:text="#{gen.mode.update}">Update</span></span>
								</div>
								
								
							</div>
							<div class="portlet-body" style="display: block; height: auto;">
								
								<div class="row">
									<div class="col-md-12 alert-zone">
									
										<!-- ALERTS ZONE -->
										<div class="alert alert-danger display-hide">
											<button class="close" data-close="alert"></button>
											<span th:text="#{gen.form.error}">You have some form
												errors. Please check below.</span>
										</div>
										<div class="alert alert-success display-hide">
											<button class="close" data-close="alert"></button>
											<span th:text="#{gen.form.success}">Your form
												validation is successful!</span>
										</div>
																						
									</div>		
									<div class="col-md-12 margin-bottom-20">									
										<form role="form" id="gadget_create_form" th:object="${gadgetTemplate}" method="post" class="form">
									  		<!-- FORM ACTIONS FOR INSERT-->
											<input th:if="${gadgetTemplate.id} == null" type="hidden" name="action" th:value="@{/gadgettemplates/create}"/>
											
											<!-- FORM ACTIONS FOR UPDATE -->											
											<input th:if="${gadgetTemplate.id} != null" type="hidden" name="action" th:value="@{/gadgettemplates/update}"/>
											<input th:if="${gadgetTemplate.id} != null" type="hidden" name="_method" value="PUT"/>								 			
								 											 			
								 			
								 			<input type="hidden" id="user" th:field="*{user}"/>
								 			<input type="hidden" id="id" th:field="*{id}"/>
								 			
								 										  
											<div class="form-body">
									 			<div class="row">
													<div class="col-md-12"> 
														<div class=" hidden alert alert-info alert-dismissable">
															<button type="button" class="close" data-dismiss="alert" aria-hidden="true"></button>
															<i class="fa fa-info-circle"></i> <strong></strong> 
															<span></span>															
														</div>
													</div>												
													<div class="col-md-3 col-sm-12">
														<div class="form-group">
															 <label class="control-label"  th:text="#{gadgettemplates.identification} + ':'">Identification</label><span class="required"> (*)</span>
															<div class="input-icon ">
																<i class="fa fa-credit-card"></i>
																<input id="identification" type="text" name="identification"  th:required="true"   maxlength="50" th:field="*{identification}" class="form-control " th:readonly="*{identification}" th:placeholder="#{gadgettemplates.identification}" />
															</div>
														</div>
													</div>	
													<div class="col-md-6 col-sm-12">														
														<div class="form-group">
															<label class="control-label"  th:text="#{gadgettemplates.description} + ':'">Description</label><span class="required"> (*)</span>
																														
																<input id="description" type="text" name="description"  th:required="true"   maxlength="50" th:field="*{description}" th:readonly="*{description}" class="form-control " th:placeholder="#{gadgettemplates.description}" />
															
														</div>
													</div>		
													<div class="col-md-3 col-sm-12">
															<div class="form-group">
																		<label class="" th:text="#{gadgettemplates.public} + ':'">Public</label>
																		<div class="mt-checkbox-list">
																			<label class="mt-checkbox popovers font-sm" data-trigger="hover" data-placement="top" data-container="body"  th:attr="data-content=#{gadgettemplates.public.help},data-title=#{gadgettemplates.public}"><i class="la la-lightbulb-o font-md"></i> <div class="inline font-xs" th:text="#{gadgettemplates.public} +'?'">Public?</div>
																				<input  id="public" class="form-control no-remove"  name="public" type="checkbox" th:field="*{public}"  />
																				<span></span>
																			</label>
																		</div>
															</div>
													</div>												
													<div class="clearfix"></div>													
												</div>
											
											
												
										<div class="portlet light ">
																	<div class="portlet-title tabbable-line">
																		<div class="tools">
																			<a href="javascript:;" class="collapse" data-original-title="" title=""> </a>
																			<a href="" class="fullscreen" data-original-title="" title=""> </a>
																		</div>
																		<label th:text="#{gadgettemplates.template.parameters.title}">Parameters Template</label>			
																		</div>
																		<div class="portlet-body">
										<div class="col-md-5 col-sm-5 col-xs-12">										
											<ul class="list-group">
											  <li class="list-group-item active" th:text="#{gadgettemplates.template.parameters.drag}">Drag the editor, the parameters you need </li>
											  <li id="label_text" class="list-group-item" draggable="true" ondragstart="GadgetsTemplateCreateController.drag(event)" th:text="#{gadgettemplates.template.parameters.text.label}">Text Label Parameter</li>
											  <li id="label_number" class="list-group-item" draggable="true" ondragstart="GadgetsTemplateCreateController.drag(event)" th:text="#{gadgettemplates.template.parameters.number.label}">Number Label Parameter</li>
											  <li id="label_ds" class="list-group-item" draggable="true" ondragstart="GadgetsTemplateCreateController.drag(event)" th:text="#{gadgettemplates.template.parameters.ds.label}">Label with data From Data Source</li>
											<!--   <li id="select_ds" class="list-group-item" draggable="true" ondragstart="GadgetsTemplateCreateController.drag(event)">Porta ac consectetur ac</li> -->
											  <li id="select_options" class="list-group-item" draggable="true" ondragstart="GadgetsTemplateCreateController.drag(event)" th:text="#{gadgettemplates.template.parameters.label.select}">Label that will be loaded with the selected value from a list</li>
											</ul>
										</div>	
										<div class="col-md-7 col-sm-7 col-xs-12">			
										<ul id="parameters-form" class="list-group">
											  <li class="list-group-item active" th:text="#{gadgettemplates.template.parameters.selected}">These are the parametric components of the template</li>
									    </ul>
										</div>																					
											</div>
											</div>
															
											
												<!-- Json-->
												<div class="row">
													<div class="col-md-12 col-sm-12 col-xs-12">
														<div class="form-group">
															<label th:text="#{gadgettemplates.template.code}">Template Code</label>														
															<textarea id="templateCode" name="templateCode" th:field="*{template}" th:required="true"  class="form-control" rows="5" data-min-rows='5'></textarea>
														</div>
														<div class="clearfix"></div>
													</div>																					
												</div>
												<!-- VIEWER -->
												<label th:text="#{gadgettemplates.template.result}">Previsualization</label>	
												<div id="viewer" class="col-md-12 col-sm-12 col-xs-12 bg-grey-carrara" style="border: 2px dotted #f5f5f5; padding: 10px 15px 10px 15px">
													<div id="gapp" ng-app="s2DashboardFramework">
													
													  <livehtml style="height:300px;width:100%;display:inline-block; overflow: auto;" class="flex layout-column" ></livehtml>
													</div>
												</div>
												<div class="clearfix"></div>
												<div style="margin-top:20px" class="form-actions">
													<div class="pull-right">
														<!-- CREATE -->
															<button th:if="${gadgetTemplate.identification} == null" id="createBtn" type="submit" class="btn btn-square btn-success " name="create"><i class="la la-check"></i> <span th:text="#{gen.createBtn}"> New</span></button>
														<!-- UPDATE -->
															<button th:if="${gadgetTemplate.id} != null" id="updateBtn" type="submit" class="btn btn-square btn-warning" name="update"><i class="la la-edit"></i> <span th:text="#{gen.editBtn}"> Edit</span></button>
																
														<!-- REMOVE -->
															<button th:if="${gadgetTemplate.id} != null" id="deleteBtn" type="button" class="btn btn-square btn-danger" name="delete"  value="Remove" th:onclick="'GadgetsTemplateCreateController.deleteGadgetTemplate(\'' + ${gadgetTemplate.id} + '\');'" ><i class="la la-trash"></i> <span th:text="#{gen.deleteBtn}"> Delete </span></button>
															
															<span class="sep" th:text="#{gen.sepBtn}"> or </span>
													
														<!-- CANCEL  -->
														<button id="cancelBtn" type="button" class="btn btn-square btn-outline red-sunglo" name="cancel"  th:value="#{gen.cancelBtn}" value="cancel" th:onclick="'javascript:GadgetsTemplateCreateController.go(\'' + @{/gadgettemplates/list} + '\');'"><i class="la la-times"></i><span th:text="#{gen.cancelBtn}"> Cancel </span></button>
													</div>
												</div>
											</div>
										</form>					

										<!-- AUXILIAR FORM TO DELETE DATASOURCE -->
										<form id="delete_gadget_template_form" class="delete-gadget hide"  th:action="@{'/gadgettemplates/'+${gadgetTemplate.id}}"  method="post">
											<input type="hidden" name="_method" value="DELETE"/>
											<input type="hidden" name="id" th:value="${gadgetTemplate.id}"/>
										</form>																	
									</div>
								</div>
							</div>
						</div>  <!-- END PORTLET BASIC LIGHT -->							
					</div><!-- END COL-12 -->						
				</div><!-- END MAIN ROW -->				
			</div><!-- END CONTENT BODY -->
		</div><!-- END CONTENT page-content-wrapper -->		
	  </div>
	 
</body>

	<!-- END MAIN PAGE WRAPPER -->
	
	<!-- FOOTER-INCLUDE -->
	<footer th:include="fragments/footer::#footerFragment" class="page-footer"> </footer>	
	
	<!-- CORE CONTROLLERS -->
	<script th:src="@{/static/js/app.js}"/>
	<script th:src="@{/static/js/layout.js}"/>
	
	<!-- PLUGINS -->	
	
	<script src="https://cdnjs.cloudflare.com/ajax/libs/muuri/0.5.4/muuri.min.js"></script>
	<script th:src="@{/static/vendor/codemirror/lib/codemirror.js}"/>
	<script th:src="@{/static/vendor/codemirror/mode/yaml/yaml.js}" />
	<script th:src="@{/static/vendor/codemirror/addon/edit/matchbrackets.js}" />
	<script th:src="@{/static/vendor/codemirror/addon/selection/active-line.js}" />
	<!-- TEMPLATE CONTROLLER  -->	
	<script th:src="@{/static/js/pages/gadgetTemplatesCreate.js}"/>
	
	
	<script src="/controlpanel/static/dashboards/scripts/vendor.js"></script>										
	<script src="/controlpanel/static/dashboards/gridster.js"></script>
	
	<!-- Angular Material Fileinput -->
	<link rel="stylesheet" href="/controlpanel/static/dashboards/resources/lf-ng-md-file-input.min.css"/>
	<script src="/controlpanel/static/dashboards/resources/lf-ng-md-file-input.min.js"></script>
	<script src="/controlpanel/static/dashboards/scripts/app.js"></script>
	<script
		th:src="@{/static/vendor/jquery-validation/jquery.validate.min.js}"
		type="text/javascript"></script>
	<script
		th:src="@{/static/vendor/jquery-validation/additional-methods.min.js}"
		type="text/javascript"></script>
		<script th:if="${lang} == 'es'"
		th:src="@{/static/vendor/jquery-validation/localization/messages_es.min.js}"
		type="text/javascript"></script>
	<script th:inline="javascript">
	
		// <![CDATA[
	 $("#createBtn,#updateBtn").on("click", function() {	
      //  $("#gadget_create_form").get(0).submit();
     });
	
	 $(window).load(function () {GadgetsTemplateCreateController.updatePreview();});
	 
	 
		var gadgetTemplateCreateJson = { 		
				"parameterTextLabel" : [[#{gadgettemplates.template.parameters.text.label}]],
				"language" : currentLanguage,
				"parameterNumberLabel" : [[#{gadgettemplates.template.parameters.number.label}]],	
				"parameterDsLabel" : [[#{gadgettemplates.template.parameters.ds.label}]],
				"titleParametersSelected" : [[#{gadgettemplates.template.parameters.selected}]],
				"parameterSelectLabel" : [[#{gadgettemplates.template.parameters.label.select}]]};
		
			
		
	// ]]>
	
	
	</script>
	
</html> 
